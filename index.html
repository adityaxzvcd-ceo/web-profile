<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Game Tani PRO</title>
<style>
body{
  margin:0;
  overflow:hidden;
  background:#87CEEB;
  font-family:sans-serif;
}
canvas{ display:block; }

#ui{
  position:absolute;
  top:15px;
  left:15px;
  background:rgba(255,255,255,0.85);
  padding:12px 18px;
  border-radius:15px;
  backdrop-filter:blur(5px);
  font-weight:bold;
}
</style>
</head>
<body>

<div id="ui">ðŸ’° Uang: <span id="money">0</span></div>
<canvas id="game"></canvas>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

let money=0;
const moneyUI=document.getElementById("money");

const worldSize=3000;
const tileSize=100;
const tiles=[];
const particles=[];

for(let x=0;x<worldSize;x+=tileSize){
  for(let y=0;y<worldSize;y+=tileSize){
    tiles.push({x,y,state:0,grow:0});
  }
}

let player={
  x:1500,y:1500,
  size:30,
  vx:0,vy:0,
  speed:0.6
};

let camera={x:0,y:0};

let keys={};
document.addEventListener("keydown",e=>keys[e.key]=true);
document.addEventListener("keyup",e=>keys[e.key]=false);

canvas.addEventListener("click",e=>{
  const mx=e.clientX+camera.x;
  const my=e.clientY+camera.y;

  tiles.forEach(t=>{
    if(mx>t.x && mx<t.x+tileSize &&
       my>t.y && my<t.y+tileSize){

      if(t.state===0){
        t.state=1;
        t.grow=0;
      }
      else if(t.state===3){
        t.state=0;
        money+=20;
        moneyUI.innerText=money;

        // Partikel panen
        for(let i=0;i<15;i++){
          particles.push({
            x:t.x+50,
            y:t.y+50,
            vx:(Math.random()-0.5)*4,
            vy:(Math.random()-1)*4,
            life:60
          });
        }
      }
    }
  });
});

function update(){

  // Smooth movement (inertia)
  if(keys["w"]||keys["ArrowUp"]) player.vy-=player.speed;
  if(keys["s"]||keys["ArrowDown"]) player.vy+=player.speed;
  if(keys["a"]||keys["ArrowLeft"]) player.vx-=player.speed;
  if(keys["d"]||keys["ArrowRight"]) player.vx+=player.speed;

  player.vx*=0.9;
  player.vy*=0.9;

  player.x+=player.vx;
  player.y+=player.vy;

  // Camera follow smooth
  camera.x+=((player.x-canvas.width/2)-camera.x)*0.1;
  camera.y+=((player.y-canvas.height/2)-camera.y)*0.1;

  // Grow plants
  tiles.forEach(t=>{
    if(t.state>0 && t.state<3){
      t.grow+=0.02;
      if(t.grow>5) t.state=2;
      if(t.grow>10) t.state=3;
    }
  });

  // Update particles
  particles.forEach(p=>{
    p.x+=p.vx;
    p.y+=p.vy;
    p.vy+=0.1;
    p.life--;
  });
}

function drawWorld(){
  ctx.fillStyle="#3cb043";
  ctx.fillRect(0,0,worldSize,worldSize);

  tiles.forEach(t=>{
    ctx.fillStyle="#8B5A2B";
    ctx.fillRect(t.x,t.y,tileSize-2,tileSize-2);

    if(t.state>0){
      ctx.save();
      ctx.translate(t.x+50,t.y+70);

      let scale=Math.min(t.grow/10,1);
      ctx.scale(scale,scale);

      // Shadow
      ctx.fillStyle="rgba(0,0,0,0.2)";
      ctx.beginPath();
      ctx.ellipse(0,15,20,8,0,0,Math.PI*2);
      ctx.fill();

      if(t.state===1) ctx.fillStyle="#66cc33";
      if(t.state===2) ctx.fillStyle="#33aa22";
      if(t.state===3) ctx.fillStyle="gold";

      ctx.fillRect(-10,-40,20,40);
      ctx.restore();
    }
  });
}

function drawPlayer(){
  ctx.save();
  ctx.translate(player.x,player.y);

  // Shadow
  ctx.fillStyle="rgba(0,0,0,0.3)";
  ctx.beginPath();
  ctx.ellipse(0,20,25,10,0,0,Math.PI*2);
  ctx.fill();

  // Body
  ctx.fillStyle="#444";
  ctx.beginPath();
  ctx.arc(0,0,player.size,0,Math.PI*2);
  ctx.fill();

  ctx.restore();
}

function drawParticles(){
  particles.forEach(p=>{
    ctx.fillStyle="gold";
    ctx.beginPath();
    ctx.arc(p.x,p.y,4,0,Math.PI*2);
    ctx.fill();
  });
}

function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  ctx.save();
  ctx.translate(-camera.x,-camera.y);

  drawWorld();
  drawPlayer();
  drawParticles();

  ctx.restore();

  update();
  requestAnimationFrame(animate);
}

animate();
</script>

</body>
</html>
